#' Complete list of palettes
#'
#' Use \code{\link{taylor_palette}} to construct palettes of desired length.
#'
#' @export
taylor_palettes <- list(
  debut = c("#09a143", "#88c8bc", "#0cb1ea", "#a0c639", "#5a411f", "#79d2f6", "#f3d2a1", "#ea989f", "#648236", "#295042"),
  debut2 = c("#92d7d6", "#038c95", "#9acbb6", "#aab45e", "#b27a78", "#c8d670", "#3cb3ab", "#37b4e0", "#94eefd", "#35f8e8"),
  debut3 = c("#34f2fe", "#00a2ad", "#6aebb3", "#97e9c1", "#c6e597"),
  fearless_TV = c("#e3ce96", "#6c4d26", "#e9e3cd", "#d2b475", "#bc9f65", "#ab8346", "#98763f", "#9b8971", "#361f0a", "#c1b4b4"),
  fearless_TV2 = c("#efc619", "#949e63", "#85C7F2", "#cab35d", "#ebdb7a", "#ee964b", "#B66D0D", "#CBE896", "#DCABDF", "#F6DB79"),
  fearless_TV3 = c("#f7ed94", "#dec477", "#c3b377", "#c49977", "#bb8f68"),
  fearless = c("#e3ce96", "#6c4d26", "#e9e3cd", "#d2b475", "#bc9f65", "#ab8346", "#98763f", "#9b8971", "#361f0a", "#c1b4b4"),
  fearless2 = c("#efc619", "#949e63", "#85C7F2", "#cab35d", "#ebdb7a", "#ee964b", "#B66D0D", "#CBE896", "#DCABDF", "#F6DB79"),
  fearless3 = c("#f7ed94", "#dec477", "#c3b377", "#c49977", "#bb8f68"),
  fearlessTV = c("#e3ce96", "#6c4d26", "#e9e3cd", "#d2b475", "#bc9f65", "#ab8346", "#98763f", "#9b8971", "#361f0a", "#c1b4b4"),
  fearlessTV2 = c("#efc619", "#949e63", "#85C7F2", "#cab35d", "#ebdb7a", "#ee964b", "#B66D0D", "#CBE896", "#DCABDF", "#F6DB79"),
  fearlessTV3 = c("#f7ed94", "#dec477", "#c3b377", "#c49977", "#bb8f68"),
  speak_now_TV = c("#d5528e", "#4f3261", "#c97cae", "#e1ae7c", "#2d2560", "#e7a3c4", "#803f95", "#b286bf", "#97314b", "#be7074"),
  speak_now_TV2 = c("#6f2dbd", "#a663cc", "#b298dc", "#b8d0eb", "#b9faf8", "#d264b6", "#631d76", "#7364d2", "#dc93f6", "#eec7fc"),
  speak_now_TV3 = c("#7f00ff", "#844abb", "#a32aa3", "#88368a", "#bd9b51"),
  speak_now = c("#d5528e", "#4f3261", "#c97cae", "#e1ae7c", "#2d2560", "#e7a3c4", "#803f95", "#b286bf", "#97314b", "#be7074"),
  speak_now2 = c("#6f2dbd", "#a663cc", "#b298dc", "#b8d0eb", "#b9faf8", "#d264b6", "#631d76", "#7364d2", "#dc93f6", "#eec7fc"),
  speak_now3 = c("#7f00ff", "#844abb", "#a32aa3", "#88368a", "#bd9b51"),
  speaknowTV = c("#d5528e", "#4f3261", "#c97cae", "#e1ae7c", "#2d2560", "#e7a3c4", "#803f95", "#b286bf", "#97314b", "#be7074"),
  speaknowTV2 = c("#6f2dbd", "#a663cc", "#b298dc", "#b8d0eb", "#b9faf8", "#d264b6", "#631d76", "#7364d2", "#dc93f6", "#eec7fc"),
  speaknowTV3 = c("#7f00ff", "#844abb", "#a32aa3", "#88368a", "#bd9b51"),
  speaknow = c("#d5528e", "#4f3261", "#c97cae", "#e1ae7c", "#2d2560", "#e7a3c4", "#803f95", "#b286bf", "#97314b", "#be7074"),
  speaknow2 = c("#6f2dbd", "#a663cc", "#b298dc", "#b8d0eb", "#b9faf8", "#d264b6", "#631d76", "#7364d2", "#dc93f6", "#eec7fc"),
  speaknow3 = c("#7f00ff", "#844abb", "#a32aa3", "#88368a", "#bd9b51"),
  speaknow_TV = c("#d5528e", "#4f3261", "#c97cae", "#e1ae7c", "#2d2560", "#e7a3c4", "#803f95", "#b286bf", "#97314b", "#be7074"),
  speaknow_TV2 = c("#6f2dbd", "#a663cc", "#b298dc", "#b8d0eb", "#b9faf8", "#d264b6", "#631d76", "#7364d2", "#dc93f6", "#eec7fc"),
  speaknow_TV3 = c("#7f00ff", "#844abb", "#a32aa3", "#88368a", "#bd9b51"),
  red_TV = c("#961710", "#8a6d58", "#290c07", "#691801", "#acae9c", "#57503b", "#ab3b32", "#c0a78f", "#71503a", "#739b9c"),
  red_TV2 = c("#e04754", "#ffcbdd", "#7c0b2b", "#d10000", "#3e000c", "#568d66", "#004733", "#e28080", "#e95555", "#ef2b2b"),
  red_TV3 = c("#bca38d", "#9e7c60", "#954d25", "#951e1a", "#48462f"),
  red = c("#961710", "#8a6d58", "#290c07", "#691801", "#acae9c", "#57503b", "#ab3b32", "#c0a78f", "#71503a", "#739b9c"),
  red2 = c("#e04754", "#ffcbdd", "#7c0b2b", "#d10000", "#3e000c", "#568d66", "#004733", "#e28080", "#e95555", "#ef2b2b"),
  red3 = c("#bca38d", "#9e7c60", "#954d25", "#951e1a", "#48462f"),
  redTV = c("#961710", "#8a6d58", "#290c07", "#691801", "#acae9c", "#57503b", "#ab3b32", "#c0a78f", "#71503a", "#739b9c"),
  redTV2 = c("#e04754", "#ffcbdd", "#7c0b2b", "#d10000", "#3e000c", "#568d66", "#004733", "#e28080", "#e95555", "#ef2b2b"),
  redTV3 = c("#bca38d", "#9e7c60", "#954d25", "#951e1a", "#48462f"),
  nineteen_eighty_nine = c("#94767e", "#d9d7e2", "#424959", "#7a9bbd", "#c2bab0", "#878d9c", "#a26548", "#bd997c", "#5980aa", "#c7ad8c"),
  nineteen_eighty_nine2 = c("#ced1fd", "#d6ebff", "#8fc6da", "#9ea0e4","#7993ef", "#c38584", "#ded6f2", "#ae418d", "#c9673b","#f38485"),
  nineteen_eighty_nine3 = c("#d2bd88", "#dcc9a8", "#d7e9ff", "#c7b8e3", "#b9bfe3"),
  reputation = c("#0b4e45", "#92aca9", "#722930", "#c55135", "#082426", "#C30950", "#f99dcb", "#496dae", "#61c9c8", "#7B0828"),
  reputation2 = c("#8b8c8b", "#6d625d", "#0a0808", "#c6b9b2", "#4a4d4d", "#7f2b41", "#8597b0", "#1625c9", "#a78f71", "#255442"),
  reputation3 = c("#eeeeee", "#727272", "#404040", "#222222", "#000000"),
  lover = c("#e6a5b9", "#f5d0c0", "#fde4bc", "#e2e5b1", "#c7c8a6", "#8cd3d4", "#87b3be", "#bbcbd8", "#ad7d8a", "#b69ca5"),
  lover2 = c("#ff64b7", "#ab6dd2", "#beddbf", "#748cc1", "#aeced8", "#eee37c", "#f7b7ed", "#5d459f", "#aededd", "#ddd9b3"),
  lover3 = c("#fdcdcd", "#dec0fc", "#cec0fd", "#adc0fb", "#94e1e9"),
  folklore = c("#909e6c", "#9c7457", "#1e221b", "#908f53", "#b3b499", "#797f71", "#d5c39f", "#4e5b33", "#a9a9a6", "#6d5d3c"),
  folklore2 = c("#7f7f7f", "#c4c4c4", "#333333", "#545454", "#a4a4a4", "#e1e1e1", "#afafaf", "#1a1a1a", "#444444", "#9b9a9b"),
  folklore3 = c("#ffffff", "#bababa", "#7f7f7f", "#353535", "#2e2e2e"),
  evermore = c("#d48452","#5f3819", "#bd3b22", "#b19d7a", "#97bab7", "#b47131", "#214E34", "#80604e", "#50A2A7", "#605a42"),
  evermore2 = c("#423629","#fbf1ce", "#cba47d", "#816956", "#18170e", "#605550", "#9c8c7c", "#6b6457", "#696164", "#c4ac9c"),
  evermore3 = c("#cd621c", "#994914", "#7f3c11", "#533211", "#372322"),
  midnights = c("#4e5d85", "#6b7ba0", "#7593ad", "#92b4c5", "#6494a5", "#757175", "#cc9475",  "#bb5953", "#c8b7b2", "#50373b"),
  midnights2 = c("#11159c", "#4eadd6", "#d2aec1", "#b17ba1", "#73dde1", "#15616d", "#9345b3",  "#789bd4", "#CFD11A", "#724CF9"),
  midnights3 = c("#b8acd0", "#e2d5f1", "#c9e8fd", "#536d86", "#4e4466"),
  all_albums = c("#9BBD4C", "#F0DE42", "#C45AB3", "#9B1D20", "#99B2DD", "#25272D", "#FF85C2", "#94A3B3", "#B87D4B", "#11159c"),
  all_albums2 = c("#8AE9C1", "#FCD757", "#885A89", "#F15025", "#AFC1D6", "#1B3022", "#EDC7CF",  "#86A397", "#524632", "#0B6884"),
  eras_tour = c("#067383", "#d9b1a7", "#ad9fba", "#f8a3c3", "#040711", "#12c6d5", "#730607", "#854569", "#eabd9f", "#bbdec2"),
  karma = c("#f69d0d", "#f45608", "#f41c34", "#e2068d", "#c200fb", "#2e005d", "#1957db",  "#7ea3f1", "#b83700", "#fbc55f")
)

#' Get a palette for Taylor Swift albums
#'
#' @param name The name of the desired palette.
#' @param n The number of items in the palette
#' @param type The type of the palette, either c("discrete", "continuous")
#'
#' @return The resulting palette.
#' @export
taylor_palette <- function(name, n, type = c("discrete", "continuous")) {
  type <- match.arg(type)

  pal <- taylor_palettes[[name]]
  if (is.null(pal))
    stop("Palette not found.")

  if (missing(n)) {
    n <- length(pal)
  }

  if (type == "discrete" && n > length(pal)) {
    stop("Number of requested colors greater than length of palette. Change type to `continuous` or use a different palette.")
  }

  if (type == "discrete") {
    out <- pal[1:n]
  } else {
    out <- grDevices::colorRampPalette(pal)(n)
  }

  structure(out, class = "palette", name = name)
}

#' Create a reversible, manual palette
#'
#' Create a function for a palette that is reversible by the user. Heavily based
#' upon [scales::manual_pal()], with influence from [scales::brewer_pal()].
#'
#' @param values The vector of values for the colors in the palette
#' @param direction Indicates whether the palette should be reversed
#'
#' @return A function that creates a palette
#' @export
pal_pal <- function(values, direction = 1) {
  force(values)
  function(n) {
    n_values <- length(values)
    if (n > n_values) {
      warning("This palette can handle a maximum of ", n_values,
              " values. You have supplied ", n, ".",
              call. = FALSE
      )
    }

    if (direction == -1) {
      values <- rev(values)
    }

    unname(values[seq_len(n)])
  }
}

#' @export
#' @importFrom graphics rect par image text
#' @importFrom grDevices rgb
print.palette <- function(x, ...) {
  n <- length(x)
  old <- par(mar = c(0.5, 0.5, 0.5, 0.5))
  on.exit(par(old))

  image(1:n, 1, as.matrix(1:n), col = x,
        ylab = "", xaxt = "n", yaxt = "n", bty = "n")

  rect(0, 0.9, n + 1, 1.1, col = rgb(1, 1, 1, 0.8), border = NA)
  text((n + 1) / 2, 1, labels = attr(x, "name"), cex = 1, family = "serif")
}
